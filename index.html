<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Sira Coranique â€” V20 (Al-'Alaq Premium)</title>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    /* -----------------------------------------------------------
       CSS (DESIGN V17 - INTACT)
       ----------------------------------------------------------- */
    @import url('https://cdn.jsdelivr.net/npm/kfgqpc-uthmanic-script-hafs-regular@1.0.0/index.min.css');
    @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&family=Fredoka:wght@400;600&display=swap');

    :root {
      --primary: #6C5CE7; --bg-body: #F0F3F8; --card-bg: #ffffff;
      --th-mekka: #a29bfe; --th-trial: #ff7675; --th-hope: #fdcb6e; --th-medina: #00cec9; --th-win: #55efc4;
      --card-shadow: 0 6px 0 rgba(0,0,0,0.05);
      --bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275);
      --quiz-bg: #2c0b56; --story-bg: #2d3436; --correct: #2ecc71; --wrong: #ff4757;
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; background: var(--bg-body); font-family: 'Nunito', sans-serif; padding-bottom: 80px; min-height: 100vh; color: #2d3436; }
    .app-container { width: 100%; max-width: 650px; margin: 0 auto; padding: 15px; }
    .d-none { display: none !important; }

    /* HEADER */
    .header-box {
      background: linear-gradient(135deg, #6C5CE7, #a29bfe); border-radius: 30px; padding: 25px 20px; color: white;
      box-shadow: 0 10px 25px rgba(108, 92, 231, 0.3); margin-bottom: 30px; text-align: center; position: relative; overflow: hidden;
    }
    .header-title { font-family: 'Fredoka', sans-serif; font-size: 1.6rem; margin: 0; position:relative; z-index:2; text-transform: uppercase; line-height: 1.3; }
    .header-sub { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; position:relative; z-index:2; font-weight: bold; }

    /* TIMELINE */
    .timeline-container { position: relative; padding-left: 20px; }
    .timeline-line {
      position: absolute; left: 29px; top: 20px; bottom: 0; width: 4px;
      background-image: linear-gradient(to bottom, #dfe6e9 50%, transparent 50%); background-size: 4px 20px; z-index: 0;
    }
    .timeline-section { margin-bottom: 40px; position: relative; z-index: 1; }
    .section-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
    .section-number {
      width: 40px; height: 40px; background: white; color: var(--primary); border: 3px solid var(--primary);
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      font-family: 'Fredoka'; font-size: 1.1rem; font-weight: 700; box-shadow: 0 4px 0 rgba(0,0,0,0.1); flex-shrink: 0;
    }
    .section-title { font-family: 'Fredoka'; font-size: 1.1rem; margin: 0; }
    .section-desc { font-size: 0.8rem; color: #636e72; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }

    /* HUB CARDS */
    .hub-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 15px; margin-left: 15px; }
    .hub-card {
      background: white; border-radius: 20px; padding: 15px; text-align: center; cursor: pointer; position: relative;
      transition: all 0.2s var(--bounce); display: flex; flex-direction: column; align-items: center; justify-content: center;
      min-height: 120px; border: 2px solid transparent; box-shadow: var(--card-shadow);
    }
    .hub-card:active { transform: scale(0.96); }
    .hub-card.locked { opacity: 0.7; background: #f1f2f6; border-bottom: 4px solid #dfe6e9; filter: grayscale(0.9); cursor: not-allowed; }
    
    .th-mekka { border-bottom: 5px solid var(--th-mekka); } .th-mekka .hub-icon { color: var(--th-mekka); }
    .th-trial { border-bottom: 5px solid var(--th-trial); } .th-trial .hub-icon { color: var(--th-trial); }
    .th-hope { border-bottom: 5px solid var(--th-hope); } .th-hope .hub-icon { color: #f39c12; }
    .th-medina { border-bottom: 5px solid var(--th-medina); } .th-medina .hub-icon { color: var(--th-medina); }
    .th-win { border-bottom: 5px solid var(--th-win); } .th-win .hub-icon { color: var(--th-win); }

    .hub-icon { font-size: 2rem; margin-bottom: 8px; display: block; }
    .hub-title-txt { font-family: 'Fredoka'; font-weight: 600; font-size: 0.9rem; margin-bottom: 3px; line-height: 1.2; }
    .hub-sub-txt { font-size: 0.7rem; font-weight: 700; color: #b2bec3; }
    .lock-icon { position: absolute; top: 10px; right: 10px; font-size: 0.9rem; color: #b2bec3; }

    /* MODULE & COMMON */
    #view-module { display: none; }
    .home-btn { 
      position: absolute; left: 20px; top: 50%; transform: translateY(-50%); 
      background: rgba(255,255,255,0.25); border: none; color: white; width: 40px; height: 40px; 
      border-radius: 50%; cursor: pointer; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; z-index: 10;
    }
    
    .verse-card { background: var(--card-bg); border-radius: 24px; padding: 20px; border-bottom: 5px solid #dfe6e9; margin-bottom: 15px; }
    .verse-card.active { border-color: var(--primary); transform: scale(1.01); box-shadow: 0 0 25px rgba(108, 92, 231, 0.4); z-index: 10; }
    .verse-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .play-btn { background: var(--primary); color: white; border: none; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; }
    .play-btn.playing { background: #ff7675; animation: pulse 1.5s infinite; }
    
    .ar-text { font-family: 'KFGQPC Uthmanic Script HAFS Regular'; text-align: right; direction: rtl; font-size: 30px; margin: 10px 0; line-height: 1.6; }
    .tr-text { color: #e17055; font-weight: 800; font-size: 15px; margin-bottom: 5px; display:block; } 
    .fr-text { font-style: italic; font-size: 15px; color: #636e72; display:block; }
    
    .toolbar { display: flex; gap: 10px; justify-content: center; margin-bottom: 10px; flex-wrap: wrap; }
    .tool-btn { background: white; border: 2px solid #dfe6e9; border-radius: 12px; padding: 8px 14px; font-weight: 800; color: #636e72; cursor: pointer; display: flex; align-items: center; gap: 5px; }
    
    .font-toolbar { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin-bottom: 25px; background: rgba(255,255,255,0.5); padding: 8px; border-radius: 16px; }
    .mini-btn { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #dfe6e9; background: white; font-weight: 900; color: #2d3436; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    
    .fabs-container { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 200; }
    .fab-btn { width: 60px; height: 60px; border-radius: 50%; border: none; color: white; font-size: 1.6rem; cursor: pointer; box-shadow: 0 6px 15px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; }
    .fab-story { background: #0984e3; border: 3px solid white; } .fab-quiz { background: #fdcb6e; border: 3px solid white; }
    .badge { background:#f1f2f6; color:#636e72; font-weight:900; padding:6px 12px; border-radius:12px; font-size:0.75rem; text-transform: uppercase; }

    /* MODALS */
    .fullscreen-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 300; display: none; flex-direction: column; overflow-y: auto; }
    .fullscreen-modal.open { display: flex; animation: fadeIn 0.3s; }
    .story-bg { background: var(--story-bg); color: white; align-items: center; padding: 20px; }
    .story-card { background: white; color: #2d3436; width: 100%; max-width: 500px; border-radius: 24px; padding: 25px; margin-top: 15px; text-align: center; }
    .story-img { font-size: 3.5rem; display: block; margin-bottom: 10px; }
    .story-title { font-family: 'Fredoka'; font-size: 1.4rem; color: var(--primary); margin-bottom: 10px; }
    .story-text { font-size: 1rem; line-height: 1.6; color: #444; margin-bottom: 15px; text-align: left; }
    
    .source-btn { background: transparent; border: 1px solid #ddd; padding: 5px 10px; border-radius: 20px; color: #7f8c8d; font-size: 0.7rem; font-weight: 700; cursor: pointer; margin-top: 10px; display:inline-flex; align-items:center; gap:5px; }
    .source-content { display: none; background: #f1f2f6; padding: 10px; border-radius: 8px; margin-top: 10px; text-align: left; font-size: 0.8rem; border-left: 3px solid var(--primary); color:#333; }
    .story-nav-btn { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 50px; font-weight: 800; font-size: 1rem; cursor: pointer; margin-top: 20px; }
    
    /* QUIZ */
    .quiz-bg { background: var(--quiz-bg); color: white; padding: 15px; align-items: center; }
    .quiz-nav { width: 100%; max-width: 600px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 10px; }
    .game-area { width: 100%; max-width: 500px; display: none; flex-direction: column; align-items: center; padding-bottom: 40px; }
    .question-box { margin-bottom: 25px; min-height: 120px; width: 100%; text-align: center; display: flex; flex-direction: column; justify-content: center; }
    .q-ar { font-family: 'KFGQPC Uthmanic Script HAFS Regular'; font-size: 3rem; direction: rtl; }
    .q-tr-game { font-family: 'Nunito'; font-size: 1rem; background: rgba(0,0,0,0.25); padding: 8px 14px; border-radius: 12px; display: inline-block; margin-top: 10px; }
    
    .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; }
    .game-btn { background: #5f27cd; color: white; border: none; padding: 16px; border-radius: 16px; font-weight: 800; cursor: pointer; box-shadow: 0 5px 0 #3c1585; min-height: 70px; display:flex; flex-direction:column; align-items:center; justify-content:center; }
    .game-btn.correct { background: var(--correct) !important; box-shadow: 0 5px 0 #219150; }
    .game-btn.wrong { background: var(--wrong) !important; box-shadow: 0 5px 0 #c0392b; opacity: 0.7; }
    
    .puzzle-dropzone { width: 100%; min-height: 100px; border: 3px dashed rgba(255,255,255,0.3); border-radius: 16px; display: flex; flex-wrap: wrap; direction: rtl !important; justify-content: flex-start; gap: 8px; padding: 10px; background: rgba(0,0,0,0.15); margin-bottom: 20px; }
    .puzzle-source { width: 100%; display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; direction: rtl !important; }
    .puzzle-piece { background: white; color: #2d3436; padding: 8px 12px; border-radius: 8px; font-family: 'KFGQPC Uthmanic Script HAFS Regular'; font-size: 1.3rem; cursor: pointer; }
    .correction-box { margin-top: 20px; background: rgba(255,255,255,0.15); padding: 15px; border-radius: 15px; color: #ffcccc; font-weight: 800; display: none; }
    
    #level-complete { position: absolute; top:0; left:0; width:100%; height:100%; background:var(--quiz-bg); z-index:500; display:none; flex-direction:column; align-items:center; justify-content:center; text-align:center; }
    .grid-menu { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; width: 100%; max-width: 500px; margin-top: 20px; }
    .menu-card { background: rgba(255,255,255,0.1); border-radius: 20px; padding: 20px 10px; text-align: center; cursor: pointer; border: 3px solid transparent; }
    .menu-icon { font-size: 2.5rem; display: block; margin-bottom: 5px; }
    .progress-track { width: 100%; max-width: 500px; height: 10px; background: rgba(255,255,255,0.2); border-radius: 10px; overflow: hidden; margin-bottom: 20px; display: none; }
    .progress-fill { height: 100%; width: 0%; background: #00cec9; transition: width 0.5s ease; }
    .close-btn { background: none; border: none; color: white; font-size: 1.4rem; cursor: pointer; opacity: 0.8; }

    @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  </style>
</head>

<body>

<div id="view-hub">
  <div class="header-box">
    <h1 class="header-title">LA MISSION DU<br>PROPHETE MUHAMMAD ï·º</h1>
    <div class="header-sub">Sira & Coran</div>
  </div>

  <div class="timeline-container">
    <div class="timeline-line"></div>

    <div class="timeline-section">
      <div class="section-header"><div class="section-number">1</div><div class="section-info"><h3 class="section-title">Avant la naissance</h3><div class="section-desc">L'Enfance</div></div></div>
      <div class="hub-grid">
        <div class="hub-card th-mekka" onclick="loadModule('al-fil')"><span class="hub-icon">ğŸ˜</span><div class="hub-title-txt">Al-Fil</div><div class="hub-sub-txt">L'Ã‰lÃ©phant</div></div>
        <div class="hub-card th-mekka locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ </span><div class="hub-title-txt">Quraysh</div><div class="hub-sub-txt">Les Faveurs</div></div>
      </div>
    </div>

    <div class="timeline-section">
      <div class="section-header"><div class="section-number">2</div><div class="section-info"><h3 class="section-title">DÃ©but RÃ©vÃ©lation</h3><div class="section-desc">Mission ProphÃ©tique</div></div></div>
      <div class="hub-grid">
        <div class="hub-card th-mekka" onclick="loadModule('al-alaq')"><span class="hub-icon">â›°ï¸</span><div class="hub-title-txt">Al-'Alaq</div><div class="hub-sub-txt">Lis !</div></div>
        <div class="hub-card th-mekka locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ›Œ</span><div class="hub-title-txt">Al-Muddathir</div><div class="hub-sub-txt">LÃ¨ve-toi</div></div>
        <div class="hub-card th-hope locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">â˜€ï¸</span><div class="hub-title-txt">Ad-Duha</div><div class="hub-sub-txt">Le Jour</div></div>
        <div class="hub-card th-hope locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">â¤ï¸</span><div class="hub-title-txt">Al-Inshirah</div><div class="hub-sub-txt">Soulagement</div></div>
      </div>
    </div>

    <div class="timeline-section">
      <div class="section-header"><div class="section-number">3</div><div class="section-info"><h3 class="section-title">Opposition</h3><div class="section-desc">PersÃ©cutions</div></div></div>
      <div class="hub-grid">
        <div class="hub-card th-hope" onclick="loadModule('ar-rum')"><span class="hub-icon">âš”ï¸</span><div class="hub-title-txt">Ar-Rum</div><div class="hub-sub-txt">Les Romains</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ”¥</span><div class="hub-title-txt">Al-Masad</div><div class="hub-sub-txt">Abou Lahab</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ¥£</span><div class="hub-title-txt">Al-Ma'oun</div><div class="hub-sub-txt">L'Entraide</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ’§</span><div class="hub-title-txt">Al-Kawthar</div><div class="hub-sub-txt">Abondance</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">âœ‹</span><div class="hub-title-txt">Al-Kafiroun</div><div class="hub-sub-txt">Les InfidÃ¨les</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ¦¯</span><div class="hub-title-txt">'Abasa</div><div class="hub-sub-txt">L'Aveugle</div></div>
        <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸŒ‘</span><div class="hub-title-txt">Al-Qamar</div><div class="hub-sub-txt">La Lune</div></div>
      </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">4</div><div class="section-info"><h3 class="section-title">Isra & Mi'raj</h3><div class="section-desc">Voyage Nocturne</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-mekka locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸŒŒ</span><div class="hub-title-txt">Al-Isra</div><div class="hub-sub-txt">Le Voyage</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">5</div><div class="section-info"><h3 class="section-title">L'HÃ©gire</h3><div class="section-desc">Migration</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ•¸ï¸</span><div class="hub-title-txt">At-Tawba</div><div class="hub-sub-txt">La Grotte</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ¦‚</span><div class="hub-title-txt">Al-Anfal</div><div class="hub-sub-txt">Complot</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">6</div><div class="section-info"><h3 class="section-title">Batailles</h3><div class="section-desc">EvÃ©nements MÃ©dine</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ›¡ï¸</span><div class="hub-title-txt">Al-Anfal</div><div class="hub-sub-txt">Badr</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ¹</span><div class="hub-title-txt">Al-Imran</div><div class="hub-sub-txt">Uhud</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ°</span><div class="hub-title-txt">Al-Ahzab</div><div class="hub-sub-txt">Le FossÃ©</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸŒ´</span><div class="hub-title-txt">Al-Hashr</div><div class="hub-sub-txt">Expulsion</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ•¯ï¸</span><div class="hub-title-txt">An-Nur</div><div class="hub-sub-txt">Calomnie</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">7</div><div class="section-info"><h3 class="section-title">La Victoire</h3><div class="section-desc">TraitÃ©s</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-win locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ³ï¸</span><div class="hub-title-txt">Al-Fath</div><div class="hub-sub-txt">Houdaybiya</div></div>
            <div class="hub-card th-win locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸš©</span><div class="hub-title-txt">An-Nasr</div><div class="hub-sub-txt">Victoire</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">8</div><div class="section-info"><h3 class="section-title">Miracles</h3><div class="section-desc">Signes Divins</div></div></div>
        <div class="hub-grid">
             <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ§</span><div class="hub-title-txt">Al-Jinn</div><div class="hub-sub-txt">Les Djinns</div></div>
             <div class="hub-card th-trial locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ›¡ï¸</span><div class="hub-title-txt">Mu'awwidhat</div><div class="hub-sub-txt">Protection</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">9</div><div class="section-info"><h3 class="section-title">Le ModÃ¨le</h3><div class="section-desc">Comportement</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">âœ¨</span><div class="hub-title-txt">Al-Qalam</div><div class="hub-sub-txt">CaractÃ¨re</div></div>
            <div class="hub-card th-medina locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ¤</span><div class="hub-title-txt">Al-Ahzab</div><div class="hub-sub-txt">ModÃ¨le</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">10</div><div class="section-info"><h3 class="section-title">Fin de Mission</h3><div class="section-desc">Accomplissement</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-win locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">â˜ï¸</span><div class="hub-title-txt">Al-Ma'ida</div><div class="hub-sub-txt">ParachÃ¨vement</div></div>
            <div class="hub-card th-win locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ</span><div class="hub-title-txt">An-Nasr</div><div class="hub-sub-txt">Les Adieux</div></div>
        </div>
    </div>

    <div class="timeline-section">
        <div class="section-header"><div class="section-number">11</div><div class="section-info"><h3 class="section-title">Juz 'Amma</h3><div class="section-desc">Autres Sourates</div></div></div>
        <div class="hub-grid">
            <div class="hub-card th-mekka locked"><span class="lock-icon">ğŸ”’</span><span class="hub-icon">ğŸ“š</span><div class="hub-title-txt">Juz 'Amma</div><div class="hub-sub-txt">Suite...</div></div>
        </div>
    </div>

  </div>
</div>

<div id="view-module">
  <div class="header-box">
    <button class="home-btn" onclick="goHome()">ğŸ </button>
    <h1 class="header-title" id="mod-title">...</h1>
  </div>
  
  <div class="toolbar">
    <div class="tool-btn">
      <span style="font-size:1.1rem">ğŸ™ï¸</span>
      <select id="reciter-opt" onchange="changeReciter(this.value)" class="reciter-select" style="min-width:100px;">
        <option value="Minshawy_Teacher_128kbps">Minshawi (Enfant)</option>
        <option value="Husary_Muallim_128kbps">Al-Hussary</option>
        <option value="Alafasy_128kbps">Mishary Alafasy</option>
      </select>
    </div>
    <button class="tool-btn" onclick="toggleLayer('tr-text', this)">ğŸ‘ï¸ PhonÃ©tique</button>
    <button class="tool-btn" onclick="toggleLayer('fr-text', this)">ğŸ“– FranÃ§ais</button>
    <button class="tool-btn" onclick="openStoryHub()" style="border-color:#0984e3; color:#0984e3;">ğŸ“œ Raconte-moi</button>
  </div>

  <div class="font-toolbar">
    <div class="font-group"><span class="font-label">AR</span><button class="mini-btn" onclick="adjustSize('ar', -2)">-</button><button class="mini-btn" onclick="adjustSize('ar', 2)">+</button></div>
    <div class="font-group" style="margin-left:15px;"><span class="font-label">FR/TR</span><button class="mini-btn" onclick="adjustSize('tr', -1); adjustSize('fr', -1)">-</button><button class="mini-btn" onclick="adjustSize('tr', 1); adjustSize('fr', 1)">+</button></div>
  </div>

  <div id="verses-container"></div>

  <div class="fabs-container">
    <button class="fab-btn fab-quiz" onclick="openGameHub()">ğŸ§ </button>
    <button class="fab-btn fab-story" onclick="openStoryHub()">ğŸ“œ</button>
  </div>
</div>

<div class="fullscreen-modal story-bg" id="story-modal">
  <div class="quiz-nav" style="color:white; border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:10px;">
    <button class="close-btn" onclick="closeStory()">âœ• Fermer</button>
    <div style="font-weight:900;">CONTEXTE SIRA</div>
  </div>
  <div id="story-age-select" class="grid-menu" style="max-width:400px;">
    <div class="menu-card" onclick="selectStoryAge('eveil')" style="background:white; color:#333;"><span class="menu-icon">ğŸ£</span><div class="menu-title">Groupe Ã‰veil</div></div>
    <div class="menu-card" onclick="selectStoryAge('chercheur')" style="background:white; color:#333;"><span class="menu-icon">ğŸ¦</span><div class="menu-title">Groupe Chercheur</div></div>
  </div>
  <div id="story-container" style="width:100%; display:none; flex-direction:column; align-items:center;"></div>
</div>

<div class="fullscreen-modal quiz-bg" id="game-modal">
  <div class="quiz-nav"><button class="close-btn" onclick="closeGameHub()">âœ• Quitter</button><div style="font-weight:900;">JEUX</div></div>
  <div class="progress-track" id="progress-track"><div class="progress-fill" id="progress-fill"></div></div>
  <div id="age-select-screen" class="grid-menu" style="max-width:400px;">
    <div class="menu-card" onclick="selectAge('age6')" style="background:white; color:#333;"><span class="menu-icon">ğŸ£</span><div class="menu-title">Groupe Ã‰veil</div></div>
    <div class="menu-card" onclick="selectAge('age8')" style="background:white; color:#333;"><span class="menu-icon">ğŸ¦</span><div class="menu-title">Groupe Chercheur</div></div>
  </div>
  <div id="level-select-screen" class="grid-menu" style="display:none; max-width:400px;">
    <div class="menu-card" onclick="selectLevel('vocab')" style="background:white; color:#333;"><span class="menu-icon">ğŸ“š</span><div class="menu-title">Vocabulaire</div></div>
    <div class="menu-card" onclick="selectLevel('puzzle')" style="background:white; color:#333;"><span class="menu-icon">ğŸ§©</span><div class="menu-title">Puzzle</div></div>
    <div class="menu-card" onclick="selectLevel('missing')" style="background:white; color:#333;"><span class="menu-icon">ğŸ§</span><div class="menu-title">Expert</div></div>
  </div>
  <div id="game-area" class="game-area">
    <div id="question-box" class="question-box"></div><div id="options-grid" class="options-grid" style="display:none;"></div>
    <div id="puzzle-area" class="puzzle-area" style="display:none;"><div id="puzzle-dropzone" class="puzzle-dropzone"></div><div id="puzzle-source" class="puzzle-source"></div></div>
    <div id="correction-box" class="correction-box"></div>
  </div>
  <div id="level-complete"><span class="neon-text">Ù…Ø§ Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡</span><h2 style="margin:0; color:white;">MA SHA ALLAH !</h2><button id="next-level-btn" class="game-btn" style="background:white; color:var(--quiz-bg); margin-top:20px; width:100%; z-index:999;" onclick="resetGame()">Menu</button></div>
</div>

<script>
  // ====================== DATA (BIBLIOTHEQUE) ======================
  const ModuleContent = {
    // 1. AL-FIL (L'Ã‰LÃ‰PHANT)
    "al-fil": {
      title: "Al-Fil (L'Ã‰lÃ©phant)", surahId: 105,
      verses: [
        { id:1, ar:"Ø£ÙÙ„ÙÙ…Û¡ ØªÙØ±Ù ÙƒÙÙŠÛ¡ÙÙ ÙÙØ¹ÙÙ„Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ø¨ÙØ£ÙØµÛ¡Ø­ÙÙ°Ø¨Ù Ù±Ù„Û¡ÙÙÙŠÙ„Ù", tr:"Alam tara kayfa fa'ala rabbuka bi-ashÃ¢bi l-fÃ®l", fr:"N'as-tu pas vu comment ton Seigneur a agi envers les gens de l'Ã‰lÃ©phant ?" },
        { id:2, ar:"Ø£ÙÙ„ÙÙ…Û¡ ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡ ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡ ÙÙÙŠ ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–", tr:"Alam yaj'al kaydahum fÃ® taá¸lÃ®l", fr:"N'a-t-Il pas rendu leur ruse complÃ¨tement vaine ?" },
        { id:3, ar:"ÙˆÙØ£ÙØ±Û¡Ø³ÙÙ„Ù Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡ Ø·ÙÙŠÛ¡Ø±Ù‹Ø§ Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù", tr:"Wa arsala 'alayhim tayran abÃ¢bÃ®l", fr:"Et envoyÃ© sur eux des oiseaux par volÃ©es," },
        { id:4, ar:"ØªÙØ±Û¡Ù…ÙÙŠÙ‡ÙÙ… Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù– Ù…ÙÙ‘Ù† Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–", tr:"TarmÃ®him bi-hijÃ¢ratin min sijjÃ®l", fr:"qui leur lanÃ§aient des pierres d'argile durcie ?" },
        { id:5, ar:"ÙÙØ¬ÙØ¹ÙÙ„ÙÙ‡ÙÙ…Û¡ ÙƒÙØ¹ÙØµÛ¡ÙÙ– Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­", tr:"Faja'alahum ka'asfin ma'kÃ»l", fr:"Il les a rendus semblables Ã  de la paille mÃ¢chÃ©e." }
      ],
      story: {
        eveil: [
          { img:"ğŸ‘‘", title:"Le Roi Jaloux", text:"Un roi mÃ©chant du YÃ©men, Abraha, Ã©tait jaloux de la Kaaba Ã  la Mecque. Il voulait que les gens viennent chez LUI.", sourceDetail:"Histoire des Arabes" },
          { img:"ğŸ˜", title:"L'ArmÃ©e", text:"Il a prÃ©parÃ© une immense armÃ©e avec des Ã©lÃ©phants gÃ©ants pour dÃ©truire la Kaaba. Les Arabes avaient trÃ¨s peur.", sourceDetail:"Sira du ProphÃ¨te" },
          { img:"ğŸ›‘", title:"Le Miracle", text:"ArrivÃ© devant la Mecque, le grand Ã©lÃ©phant (Mahmoud) s'est assis ! Il refusait d'avancer vers la Kaaba, mais il courait vers les autres directions.", sourceDetail:"Tafsir Ibn Kathir" },
          { img:"ğŸ¦…", title:"Les Oiseaux", text:"Allah a envoyÃ© des petits oiseaux (Ababil). Ils ont jetÃ© des petites pierres sur les mÃ©chants et ont sauvÃ© la Maison d'Allah.", sourceDetail:"Coran 105:3-4" }
        ],
        chercheur: [
          { img:"ğŸ“…", title:"L'AnnÃ©e de l'Ã‰lÃ©phant", text:"Cet Ã©vÃ©nement a eu lieu en 570 ap. J.C. C'est une date trÃ¨s importante car c'est l'annÃ©e de naissance du ProphÃ¨te Muhammad ï·º.", sourceDetail:"Contexte Historique" },
          { img:"ğŸ‘´", title:"Abdul-Muttalib", text:"Le grand-pÃ¨re du ProphÃ¨te a dit Ã  Abraha : 'Je suis le seigneur des chameaux, mais la Maison (Kaaba) a un Seigneur (Allah) qui la protÃ©gera.'", sourceDetail:"Ibn Hisham" },
          { img:"ğŸ§±", title:"Sijjil", text:"Les pierres Ã©taient en argile cuite (Sijjil). Chaque pierre portait le nom du soldat qu'elle devait toucher. C'Ã©tait une punition divine prÃ©cise.", sourceDetail:"Tafsir Al-Qurtubi" },
          { img:"ğŸ•‹", title:"La Protection", text:"Allah a montrÃ© qu'Il protÃ¨ge Sa maison. MÃªme sans prophÃ¨te (Ã  ce moment-lÃ ), Allah ne laisse pas le faux dÃ©truire le sacrÃ©.", sourceDetail:"LeÃ§on ThÃ©ologique" }
        ]
      },
      games: {
        age6: {
          vocab: [
            {q:"Ù±Ù„Û¡ÙÙÙŠÙ„Ù",tr:"Al-Fil",a:"L'Ã‰lÃ©phant",opts:[{t:"L'Ã‰lÃ©phant",i:"ğŸ˜"},{t:"Le Lion",i:"ğŸ¦"}]},
            {q:"Ø·ÙÙŠÛ¡Ø±Ù‹Ø§",tr:"Tayran",a:"Oiseaux",opts:[{t:"Oiseaux",i:"ğŸ¦…"},{t:"Avions",i:"âœˆï¸"}]},
            {q:"Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù",tr:"Ababil",a:"Par volÃ©es",opts:[{t:"Par volÃ©es",i:"ğŸ’¨"},{t:"Un seul",i:"â˜ï¸"}]},
            {q:"Ø­ÙØ¬ÙØ§Ø±ÙØ©Ù–",tr:"Hijara",a:"Pierres",opts:[{t:"Pierres",i:"ğŸª¨"},{t:"Bonbons",i:"ğŸ¬"}]},
            {q:"ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–",tr:"Tadlil",a:"Vaine / Echec",opts:[{t:"Vaine / Echec",i:"âŒ"},{t:"RÃ©ussite",i:"âœ…"}]},
            {q:"Ø±ÙØ¨ÙÙ‘ÙƒÙ",tr:"Rabbuka",a:"Ton Seigneur",opts:[{t:"Ton Seigneur",i:"ğŸ¤²"},{t:"Ton Ami",i:"ğŸ¤"}]}
          ],
          puzzle: [
            {full:["Ø£ÙÙ„ÙÙ…Û¡","ØªÙØ±Ù","ÙƒÙÙŠÛ¡ÙÙ","ÙÙØ¹ÙÙ„Ù","Ø±ÙØ¨ÙÙ‘ÙƒÙ"],tr:"Alam tara kayfa fa'ala rabbuka"},
            {full:["Ø¨ÙØ£ÙØµÛ¡Ø­ÙÙ°Ø¨Ù","Ù±Ù„Û¡ÙÙÙŠÙ„Ù"],tr:"Bi-ashabi l-fil"},
            {full:["Ø£ÙÙ„ÙÙ…Û¡","ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡","ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡","ÙÙÙŠ","ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–"],tr:"Alam yaj'al kaydahum fi tadlil"},
            {full:["ÙˆÙØ£ÙØ±Û¡Ø³ÙÙ„Ù","Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡","Ø·ÙÙŠÛ¡Ø±Ù‹Ø§","Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù"],tr:"Wa arsala 'alayhim tayran ababil"},
            {full:["ØªÙØ±Û¡Ù…ÙÙŠÙ‡ÙÙ…","Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù–","Ù…ÙÙ‘Ù†","Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–"],tr:"Tarmihim bi-hijaratin min sijjil"},
            {full:["ÙÙØ¬ÙØ¹ÙÙ„ÙÙ‡ÙÙ…Û¡","ÙƒÙØ¹ÙØµÛ¡ÙÙ–","Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­"],tr:"Fa-ja'alahum ka'asfin ma'kul"}
          ],
          missing: [
            {q:"Ø¨ÙØ£ÙØµÛ¡Ø­ÙÙ°Ø¨Ù .......",tr:"Bi-ashabi ...",a:"Ù±Ù„Û¡ÙÙÙŠÙ„Ù",opts:[{t:"Ù±Ù„Û¡ÙÙÙŠÙ„Ù",i:"ğŸ˜"},{t:"Ù±Ù„Û¡Ø¥ÙØ¨ÙÙ„Ù",i:"ğŸ«"}]},
            {q:"ÙˆÙØ£ÙØ±Û¡Ø³ÙÙ„Ù Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡ .......",tr:"Wa arsala 'alayhim ...",a:"Ø·ÙÙŠÛ¡Ø±Ù‹Ø§",opts:[{t:"Ø·ÙÙŠÛ¡Ø±Ù‹Ø§",i:"ğŸ¦…"},{t:"Ø±ÙÙŠØ­Ù‹Ø§",i:"ğŸŒ¬ï¸"}]},
            {q:"ØªÙØ±Û¡Ù…ÙÙŠÙ‡ÙÙ… .......",tr:"Tarmihim ...",a:"Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù–",opts:[{t:"Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù–",i:"ğŸª¨"},{t:"Ø¨ÙÙ…ÙØ§Ø¡Ù",i:"ğŸ’§"}]},
            {q:"....... ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡ ÙÙÙŠ ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–",tr:"... kaydahum fi tadlil",a:"Ø£ÙÙ„ÙÙ…Û¡ ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡",opts:[{t:"Ø£ÙÙ„ÙÙ…Û¡ ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡",i:"â“"},{t:"Ø£ÙÙ„ÙÙ…Û¡ ÙŠÙØ±Ù",i:"ğŸ‘€"}]}
          ]
        },
        age8: {
          vocab: [
            {q:"ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡",tr:"Kaydahum",a:"Leur ruse",opts:["Leur ruse","Leur maison","Leur argent"]},
            {q:"ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–",tr:"Tadlil",a:"Perdition/Echec",opts:["Perdition/Echec","Victoire","Route"]},
            {q:"Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–",tr:"Sijjil",a:"Argile durcie",opts:["Argile durcie","Fer","Feu"]},
            {q:"Ø¹ÙØµÛ¡ÙÙ–",tr:"'Asf",a:"Paille",opts:["Paille","Pain","Viande"]},
            {q:"Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­",tr:"Ma'kul",a:"MÃ¢chÃ©e",opts:["MÃ¢chÃ©e","MangÃ©e","Buvable"]},
            {q:"Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù",tr:"Ababil",a:"Par volÃ©es (Groupes)",opts:["Par volÃ©es (Groupes)","Grand","Rapide"]}
          ],
          puzzle: [
            {full:["Ø£ÙÙ„ÙÙ…Û¡","ØªÙØ±Ù","ÙƒÙÙŠÛ¡ÙÙ","ÙÙØ¹ÙÙ„Ù","Ø±ÙØ¨ÙÙ‘ÙƒÙ","Ø¨ÙØ£ÙØµÛ¡Ø­ÙÙ°Ø¨Ù","Ù±Ù„Û¡ÙÙÙŠÙ„Ù"],tr:"Verset 1 complet"},
            {full:["Ø£ÙÙ„ÙÙ…Û¡","ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡","ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡","ÙÙÙŠ","ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–"],tr:"Verset 2 complet"},
            {full:["ÙˆÙØ£ÙØ±Û¡Ø³ÙÙ„Ù","Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡","Ø·ÙÙŠÛ¡Ø±Ù‹Ø§","Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù"],tr:"Verset 3 complet"},
            {full:["ØªÙØ±Û¡Ù…ÙÙŠÙ‡ÙÙ…","Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù–","Ù…ÙÙ‘Ù†","Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–"],tr:"Verset 4 complet"},
            {full:["ÙÙØ¬ÙØ¹ÙÙ„ÙÙ‡ÙÙ…Û¡","ÙƒÙØ¹ÙØµÛ¡ÙÙ–","Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­"],tr:"Verset 5 complet"}
          ],
          missing: [
            {q:"....... Ø±ÙØ¨ÙÙ‘ÙƒÙ Ø¨ÙØ£ÙØµÛ¡Ø­ÙÙ°Ø¨Ù Ù±Ù„Û¡ÙÙÙŠÙ„Ù",tr:"... Rabbuka bi-ashabi l-fil",a:"ÙÙØ¹ÙÙ„Ù",opts:["ÙÙØ¹ÙÙ„Ù","Ù‚ÙØ§Ù„Ù"]},
            {q:"Ø£ÙÙ„ÙÙ…Û¡ ÙŠÙØ¬Û¡Ø¹ÙÙ„Û¡ ....... ÙÙÙŠ ØªÙØ¶Û¡Ù„ÙÙŠÙ„Ù–",tr:"Alam yaj'al ... fi tadlil",a:"ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡",opts:["ÙƒÙÙŠÛ¡Ø¯ÙÙ‡ÙÙ…Û¡","Ø£ÙÙ…Ù’Ø±ÙÙ‡ÙÙ…Û¡"]},
            {q:"ÙˆÙØ£ÙØ±Û¡Ø³ÙÙ„Ù Ø¹ÙÙ„ÙÙŠÛ¡Ù‡ÙÙ…Û¡ ....... Ø£ÙØ¨ÙØ§Ø¨ÙÙŠÙ„Ù",tr:"Wa arsala ... ababil",a:"Ø·ÙÙŠÛ¡Ø±Ù‹Ø§",opts:["Ø·ÙÙŠÛ¡Ø±Ù‹Ø§","Ù…ÙÙ„ÙÙ°Ù“Ø¦ÙÙƒÙØ©Ù—"]},
            {q:"ØªÙØ±Û¡Ù…ÙÙŠÙ‡ÙÙ… Ø¨ÙØ­ÙØ¬ÙØ§Ø±ÙØ©Ù– Ù…ÙÙ‘Ù† .......",tr:"Tarmihim ... min ...",a:"Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–",opts:["Ø³ÙØ¬ÙÙ‘ÙŠÙ„Ù–","Ø°ÙÙ‡ÙØ¨Ù–"]},
            {q:"ÙÙØ¬ÙØ¹ÙÙ„ÙÙ‡ÙÙ…Û¡ ÙƒÙØ¹ÙØµÛ¡ÙÙ– .......",tr:"Faja'alahum ka'asfin ...",a:"Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­",opts:["Ù…ÙÙ‘Ø£Û¡ÙƒÙÙˆÙ„ÙÛ­","Ù…ÙØ´Ù’Ø±ÙÙˆØ¨Ù–"]}
          ]
        }
      }
    },

    // 2. AL-ALAQ (LA RÃ‰VÃ‰LATION) - VERSION PREMIUM VALIDEE
    "al-alaq": {
      title: "Al-'Alaq (L'AdhÃ©rence)", surahId: 96,
      verses: [
        { id:1, ar:"Ù±Ù‚Û¡Ø±ÙØ£Û¡ Ø¨ÙÙ±Ø³Û¡Ù…Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù", tr:"Iqra' bismi rabbika alladhi khalaq", fr:"Lis, au nom de ton Seigneur qui a crÃ©Ã©," },
        { id:2, ar:"Ø®ÙÙ„ÙÙ‚Ù Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙÙ†Û¡ Ø¹ÙÙ„ÙÙ‚Ù", tr:"Khalaqa al-insana min 'alaq", fr:"qui a crÃ©Ã© l'homme d'une adhÃ©rence." },
        { id:3, ar:"Ù±Ù‚Û¡Ø±ÙØ£Û¡ ÙˆÙØ±ÙØ¨ÙÙ‘ÙƒÙ Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù", tr:"Iqra' wa rabbuka al-akram", fr:"Lis ! Ton Seigneur est le TrÃ¨s Noble," },
        { id:4, ar:"Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø¹ÙÙ„ÙÙ‘Ù…Ù Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù", tr:"Alladhi 'allama bil-qalam", fr:"qui a enseignÃ© par la plume (le calame)," },
        { id:5, ar:"Ø¹ÙÙ„ÙÙ‘Ù…Ù Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙØ§ Ù„ÙÙ…Û¡ ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡", tr:"'Allama al-insana ma lam ya'lam", fr:"a enseignÃ© Ã  l'homme ce qu'il ne savait pas." }
      ],
      story: {
        eveil: [
          { img:"â›°ï¸", title:"La Grotte Silencieuse", text:"Le ProphÃ¨te Muhammad ï·º nâ€™aimait pas les mauvaises choses que faisaient les gens de La Mecque (les idoles). Il aimait Ãªtre seul pour penser Ã  Allah. Il montait tout en haut de la montagne de la LumiÃ¨re (Jabal Al-Nour), dans une petite grotte appelÃ©e Hira. LÃ -bas, tout Ã©tait calme et sombre. Il restait plusieurs nuits Ã  rÃ©flÃ©chir et Ã  prier, loin du bruit de la ville.", sourceDetail:"Sources : Al-Omari [16], Rashid Rida [3]" },
          { img:"âœ¨", title:"Lâ€™Ange et le CÃ¢lin", text:"Une nuit, alors quâ€™il Ã©tait dans la grotte, lâ€™ange Jibril (Gabriel) est soudain apparu ! Il a pris le ProphÃ¨te dans ses bras et lâ€™a serrÃ© trÃ¨s fort, jusquâ€™Ã  ce quâ€™il ait du mal Ã  respirer. Lâ€™ange lui a dit : Â« Lis ! Â» (Iqra). Le ProphÃ¨te, effrayÃ©, a rÃ©pondu : Â« Je ne sais pas lire ! Â» Lâ€™ange lâ€™a serrÃ© trois fois et a rÃ©pÃ©tÃ© : Â« Lis ! Â»", sourceDetail:"Sources : Al-Wahy Al-Muhammadi [3]" },
          { img:"ğŸƒ", title:"Cours vite Ã  la maison !", text:"Le ProphÃ¨te a eu trÃ¨s peur ! Il est vite rentrÃ© chez lui, le cÅ“ur battant trÃ¨s fort. Il tremblait tellement quâ€™il a demandÃ© Ã  sa femme Khadija : Â« Couvrez-moi ! Couvrez-moi ! Â» (Zammilouni). Khadija lâ€™a enveloppÃ© dans une couverture pour le rassurer.", sourceDetail:"Sources : Sahih Bukhari, Al-Omari [16]" },
          { img:"ğŸ ", title:"Le RÃ©confort de Khadija", text:"Khadija (ra) a Ã©tÃ© trÃ¨s gentille et courageuse. Elle a rassurÃ© le ProphÃ¨te en lui disant : Â« Nâ€™aie pas peur. Allah ne tâ€™abandonnera jamais, car tu es gentil avec tout le monde et tu aides les pauvres. Â» Elle a Ã©tÃ© la premiÃ¨re personne Ã  croire en lui.", sourceDetail:"Sources : Kanz al-Ummal [10], Zino [20]" }
        ],
        chercheur: [
          { img:"ğŸ©¸", title:"Miracle Scientifique", text:"Le mot 'Alaq (Ø¹ÙÙ„ÙÙ‚Ù) a 3 sens en arabe : sangsue, chose suspendue, et caillot de sang. C'est exactement l'apparence de l'embryon humain Ã  ce stade. Un miracle dÃ©crit il y a 1400 ans.", sourceDetail:"Dr. Keith Moore (Embryologiste) & Tafsir." },
          { img:"âœï¸", title:"Le Paradoxe", text:"Le premier ordre d'Allah est 'Lis' (Iqra), donnÃ© Ã  un homme qui ne savait ni lire ni Ã©crire (IllettrÃ©/Ummi). C'est la preuve que le Coran ne vient pas de lui.", sourceDetail:"Preuve de la ProphÃ©tie." },
          { img:"ğŸ“œ", title:"Waraqa Ibn Nawfal", text:"Khadija l'a emmenÃ© voir son cousin Waraqa, un vieux sage chrÃ©tien. Waraqa a pleurÃ© et dit : 'C'est le Namous (La Loi/L'Ange) qui est venu Ã  Moussa ! Tu es le ProphÃ¨te de cette nation.'", sourceDetail:"Sahih Bukhari - Hadith 3." },
          { img:"ğŸ¦", title:"La PrÃ©diction", text:"Waraqa a aussi prÃ©venu : 'Ton peuple te chassera.' Le ProphÃ¨te Ã©tait choquÃ© : 'Vont-ils me chasser ?'. Waraqa rÃ©pondit : 'Jamais un homme n'est venu avec ce message sans Ãªtre combattu.'", sourceDetail:"DÃ©but des Ã©preuves (Sira Ibn Hisham)." }
        ]
      },
      games: {
        age6: {
          vocab: [
            {q:"Ù±Ù‚Û¡Ø±ÙØ£Û¡",tr:"Iqra'",a:"Lis !",opts:[{t:"Lis !",i:"ğŸ“–"},{t:"Ã‰cris !",i:"âœï¸"}]},
            {q:"Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù",tr:"Al-Insan",a:"L'Homme",opts:[{t:"L'Homme",i:"ğŸ‘¤"},{t:"L'Ange",i:"âœ¨"}]},
            {q:"Ø¹ÙÙ„ÙÙ‚Ù",tr:"'Alaq",a:"AdhÃ©rence",opts:[{t:"AdhÃ©rence",i:"ğŸ©¸"},{t:"Eau",i:"ğŸ’§"}]},
            {q:"Ù±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù",tr:"Al-Qalam",a:"La Plume",opts:[{t:"La Plume",i:"ğŸ–‹ï¸"},{t:"Le Livre",i:"ğŸ“˜"}]},
            {q:"Ø®ÙÙ„ÙÙ‚Ù",tr:"Khalaqa",a:"Il a crÃ©Ã©",opts:[{t:"Il a crÃ©Ã©",i:"ğŸ—ï¸"},{t:"Il a dÃ©truit",i:"ğŸ’¥"}]},
            {q:"Ù±Ù„ÙÙ‘Ø°ÙÙŠ",tr:"Alladhi",a:"Celui qui",opts:[{t:"Celui qui",i:"â˜ï¸"},{t:"OÃ¹",i:"ğŸ“"}]}
          ],
          puzzle: [
            {full:["Ù±Ù‚Û¡Ø±ÙØ£Û¡","Ø¨ÙÙ±Ø³Û¡Ù…Ù","Ø±ÙØ¨ÙÙ‘ÙƒÙ","Ù±Ù„ÙÙ‘Ø°ÙÙŠ","Ø®ÙÙ„ÙÙ‚Ù"],tr:"Iqra' bismi rabbika alladhi khalaq"},
            {full:["Ø®ÙÙ„ÙÙ‚Ù","Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù","Ù…ÙÙ†Û¡","Ø¹ÙÙ„ÙÙ‚Ù"],tr:"Khalaqa al-insana min 'alaq"},
            {full:["Ù±Ù‚Û¡Ø±ÙØ£Û¡","ÙˆÙØ±Ùâ€ŒØ¨ÙÙ‘ÙƒÙ","Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù"],tr:"Iqra' wa rabbuka al-akram"},
            {full:["Ù±Ù„ÙÙ‘Ø°ÙÙŠ","Ø¹ÙÙ„ÙÙ‘Ù…Ù","Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù"],tr:"Alladhi 'allama bil-qalam"},
            {full:["Ø¹ÙÙ„ÙÙ‘Ù…Ù","Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù","Ù…ÙØ§","Ù„ÙÙ…Û¡","ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡"],tr:"'Allama al-insana ma lam ya'lam"}
          ],
          missing: [
            {q:"Ù±Ù‚Û¡Ø±ÙØ£Û¡ Ø¨ÙÙ±Ø³Û¡Ù…Ù ....... Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù",tr:"Iqra' bismi ... alladhi khalaq",a:"Ø±ÙØ¨ÙÙ‘ÙƒÙ",opts:[{t:"Ø±ÙØ¨ÙÙ‘ÙƒÙ",i:"ğŸ¤²"},{t:"Ù†ÙØ¨ÙÙŠÙÙ‘ÙƒÙ",i:"ğŸ‘³"}]},
            {q:"Ø®ÙÙ„ÙÙ‚Ù Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙÙ†Û¡ .......",tr:"Khalaqa l-insana min ...",a:"Ø¹ÙÙ„ÙÙ‚Ù",opts:[{t:"Ø¹ÙÙ„ÙÙ‚Ù",i:"ğŸ©¸"},{t:"ØªÙØ±ÙØ§Ø¨Ù",i:"ğŸœï¸"}]},
            {q:"Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø¹ÙÙ„ÙÙ‘Ù…Ù .......",tr:"Alladhi 'allama ...",a:"Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù",opts:[{t:"Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù",i:"ğŸ–‹ï¸"},{t:"Ø¨ÙÙ±Ù„Ø³ÙÙ‘ÙŠÙ’ÙÙ",i:"âš”ï¸"}]},
            {q:"....... Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙØ§ Ù„ÙÙ…Û¡ ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡",tr:"... al-insana ma lam ya'lam",a:"Ø¹ÙÙ„ÙÙ‘Ù…Ù",opts:[{t:"Ø¹ÙÙ„ÙÙ‘Ù…Ù",i:"ğŸ§ "},{t:"Ø®ÙÙ„ÙÙ‚Ù",i:"âœ¨"}]}
          ]
        },
        age8: {
          vocab: [
            {q:"Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù",tr:"Al-Akram",a:"Le TrÃ¨s GÃ©nÃ©reux",opts:["Le TrÃ¨s GÃ©nÃ©reux","Le TrÃ¨s Puissant","Le TrÃ¨s Savant"]},
            {q:"Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù",tr:"Bil-Qalam",a:"Par la plume",opts:["Par la plume","Par la parole","Par l'Ã©pÃ©e"]},
            {q:"Ù…ÙØ§ Ù„ÙÙ…Û¡ ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡",tr:"Ma lam ya'lam",a:"Ce qu'il ne savait pas",opts:["Ce qu'il ne savait pas","Ce qu'il a oubliÃ©","Ce qu'il a vu"]},
            {q:"Ø¹ÙÙ„ÙÙ‚Ù",tr:"'Alaq",a:"Caillot / AdhÃ©rence",opts:["Caillot / AdhÃ©rence","Argile","Eau"]},
            {q:"Ù±Ù‚Û¡Ø±ÙØ£Û¡",tr:"Iqra'",a:"Lis (Ordre)",opts:["Lis (Ordre)","Ã‰coute","Regarde"]},
            {q:"Ø±ÙØ¨ÙÙ‘ÙƒÙ",tr:"Rabbuka",a:"Ton Seigneur (Ã‰ducateur)",opts:["Ton Seigneur (Ã‰ducateur)","Ton Roi","Ton CrÃ©ateur"]}
          ],
          puzzle: [
            {full:["Ù±Ù‚Û¡Ø±ÙØ£Û¡","Ø¨ÙÙ±Ø³Û¡Ù…Ù","Ø±ÙØ¨ÙÙ‘ÙƒÙ","Ù±Ù„ÙÙ‘Ø°ÙÙŠ","Ø®ÙÙ„ÙÙ‚Ù"],tr:"Verset 1"},
            {full:["Ø®ÙÙ„ÙÙ‚Ù","Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù","Ù…ÙÙ†Û¡","Ø¹ÙÙ„ÙÙ‚Ù"],tr:"Verset 2"},
            {full:["Ù±Ù‚Û¡Ø±ÙØ£Û¡","ÙˆÙØ±Ùâ€ŒØ¨ÙÙ‘ÙƒÙ","Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù"],tr:"Verset 3"},
            {full:["Ù±Ù„ÙÙ‘Ø°ÙÙŠ","Ø¹ÙÙ„ÙÙ‘Ù…Ù","Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù"],tr:"Verset 4"},
            {full:["Ø¹ÙÙ„ÙÙ‘Ù…Ù","Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù","Ù…ÙØ§","Ù„ÙÙ…Û¡","ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡"],tr:"Verset 5"}
          ],
          missing: [
            {q:"....... Ø¨ÙÙ±Ø³Û¡Ù…Ù Ø±ÙØ¨ÙÙ‘ÙƒÙ Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø®ÙÙ„ÙÙ‚Ù",tr:"... bismi rabbika...",a:"Ù±Ù‚Û¡Ø±ÙØ£Û¡",opts:["Ù±Ù‚Û¡Ø±ÙØ£Û¡","Ù‚ÙÙ„Û¡"]},
            {q:"Ù±Ù‚Û¡Ø±ÙØ£Û¡ ÙˆÙØ±ÙØ¨ÙÙ‘ÙƒÙ .......",tr:"Iqra' wa rabbuka...",a:"Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù",opts:["Ù±Ù„Û¡Ø£ÙÙƒÛ¡Ø±ÙÙ…Ù","Ù±Ù„Ù’Ø¹ÙØ¸ÙÙŠÙ…Ù"]},
            {q:"Ù±Ù„ÙÙ‘Ø°ÙÙŠ Ø¹ÙÙ„ÙÙ‘Ù…Ù .......",tr:"Alladhi 'allama...",a:"Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù",opts:["Ø¨ÙÙ±Ù„Û¡Ù‚ÙÙ„ÙÙ…Ù","Ø¨ÙÙ±Ù„Ù’ÙˆÙØ­Ù’ÙŠÙ"]},
            {q:"Ø¹ÙÙ„ÙÙ‘Ù…Ù Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙØ§ Ù„ÙÙ…Û¡ .......",tr:"... ma lam...",a:"ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡",opts:["ÙŠÙØ¹Û¡Ù„ÙÙ…Û¡","ÙŠÙÙÙ’Ù‡ÙÙ…Û¡"]},
            {q:"Ø®ÙÙ„ÙÙ‚Ù Ù±Ù„Û¡Ø¥ÙÙ†Ø³ÙÙ°Ù†Ù Ù…ÙÙ†Û¡ .......",tr:"Khalaqa al-insana min...",a:"Ø¹ÙÙ„ÙÙ‚Ù",opts:["Ø¹ÙÙ„ÙÙ‚Ù","Ù…ÙØ§Ø¡Ù"]}
          ]
        }
      }
    },

    // 5. AR-ROUM (LES ROMAINS)
    "ar-rum": {
      title: "Ar-Rum (Les Romains)", surahId: 30,
      verses: [
        { id:1, ar:"Ø§Ù„Ù“Ù…Ù“", tr:"Alif - LÃ¢m - MÃ®m", fr:"Alif, LÃ¢m, MÃ®m." },
        { id:2, ar:"ØºÙÙ„ÙØ¨ÙØªÙ Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù", tr:"Ghoulibati r-Roum", fr:"Les Romains ont Ã©tÃ© vaincus," },
        { id:3, ar:"ÙÙÙŠÙ“ Ø£ÙØ¯Û¡Ù†ÙÙ‰ Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù ÙˆÙÙ‡ÙÙ… Ù…ÙÙ‘Ù†Û¢ Ø¨ÙØ¹Û¡Ø¯Ù ØºÙÙ„ÙØ¨ÙÙ‡ÙÙ…Û¡ Ø³ÙÙŠÙØºÛ¡Ù„ÙØ¨ÙÙˆÙ†Ù", tr:"FÄ« adna l-ará¸i wa hum min baâ€˜di ghalabihim sayaghlibÅ«n", fr:"dans le pays voisin, et aprÃ¨s leur dÃ©faite ils seront vainqueurs," },
        { id:4, ar:"ÙÙÙŠ Ø¨ÙØ¶Û¡Ø¹Ù Ø³ÙÙ†ÙÙŠÙ†ÙÛ— Ù„ÙÙ„ÙÙ‘Ù‡Ù Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù Ù…ÙÙ† Ù‚ÙØ¨Û¡Ù„Ù ÙˆÙÙ…ÙÙ†Û¢ Ø¨ÙØ¹Û¡Ø¯ÙÛš ÙˆÙÙŠÙÙˆÛ¡Ù…ÙØ¦ÙØ°Ù– ÙŠÙÙÛ¡Ø±ÙØ­Ù Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù", tr:"FÄ« biá¸â€˜i sinÄ«n. LillÄhi l-amru min qablu wa min baâ€˜du wa-yawma-idhin yafraá¸¥u al-muâ€™minÅ«n", fr:"dans quelques annÃ©es. Ã€ Allah appartient le commandement, avant comme aprÃ¨s, et ce jour-lÃ  les Croyants se rÃ©jouiront." }
      ],
      story: {
        eveil: [
          { img:"âš”ï¸", title:"La Guerre", text:"Il y a longtemps, deux grands pays se faisaient la guerre : les Romains et les Perses. Les Perses Ã©taient trÃ¨s forts et ont gagnÃ© une grande bataille.", sourceDetail:"Contexte Historique 614 ap. J.C" },
          { img:"ğŸ˜¢", title:"La Tristesse", text:"Ã€ la Mecque, les croyants Ã©taient tristes. Les mÃ©chants se moquaient d'eux : 'Vos amis les Romains ont perdu, vous allez perdre aussi !'", sourceDetail:"Tafsir Ibn Kathir" },
          { img:"âœ¨", title:"La Promesse", text:"Mais Allah a envoyÃ© le ProphÃ¨te ï·º pour dire : 'Ne soyez pas tristes ! Dans quelques annÃ©es, les Romains vont gagner !' C'Ã©tait une promesse d'Allah.", sourceDetail:"Coran 30:2-4" },
          { img:"ğŸ†", title:"La Victoire", text:"Et c'est arrivÃ© ! Quelques annÃ©es plus tard, les Romains ont gagnÃ©. Allah dit toujours la vÃ©ritÃ© et aide les croyants.", sourceDetail:"Histoire : CoÃ¯ncide avec la bataille de Badr." }
        ],
        chercheur: [
          { img:"âš”ï¸", title:"Le Contexte GÃ©opolitique", text:"Les Perses (Sassanides) ont Ã©crasÃ© les Romains (Byzantins) et ont mÃªme pris JÃ©rusalem. C'Ã©tait un choc mondial !", sourceDetail:"Ibn Kathir (Tafsir Ar-Rum) : Les Perses dominaient tout le Proche-Orient vers 614-615." },
          { img:"ğŸ˜§", title:"Le Choc Ã  la Mecque", text:"Les polythÃ©istes de la Mecque disaient aux Compagnons : 'Les adorateurs du feu (Perses) ont battu les Gens du Livre (Romains). Nous aussi, nous vous battrons !'", sourceDetail:"Jami` at-Tirmidhi 3193 : Les mÃ©crÃ©ants aimaient voir les Perses gagner." },
          { img:"ğŸ¤", title:"Le Pari (Al-Mouqabala)", text:"Abu Bakr (ra) Ã©tait si sÃ»r de la rÃ©vÃ©lation qu'il a fait un pari avec Ubayy bin Khalaf : 100 chameaux que les Romains gagneront !", sourceDetail:"At-Tirmidhi 3193 (Sahih) : C'Ã©tait avant l'interdiction des jeux de hasard." },
          { img:"â³", title:"La DÃ©finition de 'Bid'", text:"Le Coran utilise le mot 'Bid'i Sinin'. En arabe pur, cela signifie entre 3 et 9 ans. La prophÃ©tie Ã©tait donc trÃ¨s prÃ©cise.", sourceDetail:"Linguistique Arabe : Bid' (Ø¨Ø¶Ø¹) dÃ©signe un nombre de 3 Ã  9." },
          { img:"ğŸš«", title:"L'AumÃ´ne (Sadaqah)", text:"Abu Bakr a gagnÃ© le pari ! Mais le jeu de hasard venait d'Ãªtre interdit. Le ProphÃ¨te ï·º lui a dit : 'C'est un gain illicite (Suh't), donne-le aux pauvres.'", sourceDetail:"At-Tirmidhi : L'Islam interdit de profiter des gains de paris." }
        ]
      },
      games: {
        age6: {
          vocab: [
            {q:"Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù",tr:"Ar-Roum",a:"Les Romains",opts:[{t:"Les Romains",i:"ğŸ›¡ï¸"},{t:"La Terre",i:"ğŸŒ"}]},
            {q:"ØºÙÙ„ÙØ¨ÙØªÙ",tr:"Ghoulibati",a:"Ont Ã©tÃ© vaincus",opts:[{t:"Ont Ã©tÃ© vaincus",i:"ğŸ³ï¸"},{t:"Ont gagnÃ©",i:"ğŸ†"}]},
            {q:"Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù",tr:"Al-Ard",a:"La Terre",opts:[{t:"La Terre",i:"ğŸŒ"},{t:"Le Ciel",i:"â˜ï¸"}]},
            {q:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",tr:"Yafrahou",a:"Se rÃ©jouir",opts:[{t:"Se rÃ©jouir",i:"ğŸ˜Š"},{t:"Pleurer",i:"ğŸ˜¢"}]},
            {q:"Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù",tr:"Al-Mouminoun",a:"Les Croyants",opts:[{t:"Les Croyants",i:"ğŸ¤²"},{t:"Les Autos",i:"ğŸš—"}]},
            {q:"Ø³ÙÙ†ÙÙŠÙ†Ù",tr:"Sinin",a:"AnnÃ©es",opts:[{t:"AnnÃ©es",i:"ğŸ“…"},{t:"Jours",i:"â˜€ï¸"}]}
          ],
          puzzle: [
            {full:["ØºÙÙ„ÙØ¨ÙØªÙ","Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù"],tr:"Ghoulibati r-Roum"},
            {full:["ÙÙÙŠÙ“","Ø£ÙØ¯Û¡Ù†ÙÙ‰","Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù"],tr:"Fi adna l-ardi"},
            {full:["Ù„ÙÙ„ÙÙ‘Ù‡Ù","Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù"],tr:"Lillahi l-amr"},
            {full:["ÙˆÙÙŠÙÙˆÛ¡Ù…ÙØ¦ÙØ°Ù–","ÙŠÙÙÛ¡Ø±ÙØ­Ù"],tr:"Wa yawma-idhin yafrahu"},
            {full:["ÙŠÙÙÛ¡Ø±ÙØ­Ù","Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù"],tr:"Yafrahu l-mouminoun"},
            {full:["Ù…ÙÙ†","Ù‚ÙØ¨Û¡Ù„Ù"],tr:"Min qablu"}
          ],
          missing: [
            {q:"ØºÙÙ„ÙØ¨ÙØªÙ .......",tr:"Ghoulibati ...",a:"Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù",opts:[{t:"Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù",i:"ğŸ›¡ï¸"},{t:"Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù",i:"ğŸŒ"}]},
            {q:"....... Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù",tr:"... l-amr",a:"Ù„ÙÙ„ÙÙ‘Ù‡Ù",opts:[{t:"Ù„ÙÙ„ÙÙ‘Ù‡Ù",i:"â˜ï¸"},{t:"Ù„ÙÙ„Ù†ÙÙ‘Ø§Ø³Ù",i:"ğŸ‘¥"}]},
            {q:"ÙˆÙÙŠÙÙˆÛ¡Ù…ÙØ¦ÙØ°Ù– .......",tr:"Wa yawma-idhin ...",a:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",opts:[{t:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",i:"ğŸ˜Š"},{t:"ÙŠÙØ¨Û¡ÙƒÙÙŠ",i:"ğŸ˜¢"}]},
            {q:"....... Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù",tr:"... l-mouminoun",a:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",opts:[{t:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",i:"ğŸ˜Š"},{t:"ÙŠÙÙ†ÙØ§Ù…Ù",i:"ğŸ˜´"}]},
            {q:"ÙÙÙŠ Ø¨ÙØ¶Û¡Ø¹Ù .......",tr:"Fi bid'i ...",a:"Ø³ÙÙ†ÙÙŠÙ†Ù",opts:[{t:"Ø³ÙÙ†ÙÙŠÙ†Ù",i:"ğŸ“…"},{t:"Ø£ÙÙŠÙÙ‘Ø§Ù…Ù",i:"â˜€ï¸"}]},
            {q:"ÙÙÙŠÙ“ Ø£ÙØ¯Û¡Ù†ÙÙ‰ .......",tr:"Fi adna ...",a:"Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù",opts:[{t:"Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù",i:"ğŸŒ"},{t:"Ù±Ù„Ø³ÙÙ‘Ù…ÙØ¢Ø¡Ù",i:"â˜ï¸"}]}
          ]
        },
        age8: {
          vocab: [
            {q:"ØºÙÙ„ÙØ¨ÙØªÙ",tr:"Ghoulibati",a:"Ont Ã©tÃ© vaincus",opts:["Ont gagnÃ©","Ont Ã©tÃ© vaincus","Ont voyagÃ©"]},
            {q:"Ø¨ÙØ¶Û¡Ø¹Ù",tr:"Biá¸â€˜i",a:"3 Ã  9",opts:["Beaucoup","Un seul","3 Ã  9"]},
            {q:"Ø£ÙØ¯Û¡Ù†ÙÙ‰",tr:"Adna",a:"Voisin / Plus bas",opts:["Plus haut","Voisin / Plus bas","Lointain"]},
            {q:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",tr:"Yafrahu",a:"Se rÃ©jouir",opts:["Se rÃ©jouir","Pleurer","Dormir"]},
            {q:"Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù",tr:"Al-Amr",a:"Le Commandement",opts:["Le Conseil","Le Commandement","L'Argent"]},
            {q:"Ø³ÙÙŠÙØºÛ¡Ù„ÙØ¨ÙÙˆÙ†Ù",tr:"Sayaghliboun",a:"Ils vaincront",opts:["Ils vaincront","Ils perdront","Ils partiront"]}
          ],
          puzzle: [
            {full:["ØºÙÙ„ÙØ¨ÙØªÙ","Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù"],tr:"Ghoulibati r-Roum"},
            {full:["ÙÙÙŠÙ“","Ø£ÙØ¯Û¡Ù†ÙÙ‰","Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù"],tr:"Fi adna l-ardi"},
            {full:["ÙˆÙÙ‡ÙÙ…","Ù…ÙÙ‘Ù†Û¢","Ø¨ÙØ¹Û¡Ø¯Ù","ØºÙÙ„ÙØ¨ÙÙ‡ÙÙ…Û¡","Ø³ÙÙŠÙØºÛ¡Ù„ÙØ¨ÙÙˆÙ†Ù"],tr:"Wa hum min ba'di ghalabihim sayaghlibÅ«n"},
            {full:["Ù„ÙÙ„ÙÙ‘Ù‡Ù","Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù","Ù…ÙÙ†","Ù‚ÙØ¨Û¡Ù„Ù","ÙˆÙÙ…ÙÙ†Û¢","Ø¨ÙØ¹Û¡Ø¯ÙÛš"],tr:"LillÄhi l-amru min qablu wa min ba'du"},
            {full:["ÙˆÙÙŠÙÙˆÛ¡Ù…ÙØ¦ÙØ°Ù–","ÙŠÙÙÛ¡Ø±ÙØ­Ù","Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù"],tr:"Wa yawma-idhin yafrahu l-mouminoun"},
            {full:["ÙÙÙŠ","Ø¨ÙØ¶Û¡Ø¹Ù","Ø³ÙÙ†ÙÙŠÙ†Ù"],tr:"Fi bid'i sinin"}
          ],
          missing: [
            {q:"ØºÙÙ„ÙØ¨ÙØªÙ .......",tr:"Ghoulibati ...",a:"Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù",opts:["Ù±Ù„Ø±ÙÙ‘ÙˆÙ…Ù","Ù±Ù„Û¡ÙÙØ±Û¡Ø³Ù"]},
            {q:"....... Ù±Ù„Û¡Ø£ÙÙ…Û¡Ø±Ù Ù…ÙÙ† Ù‚ÙØ¨Û¡Ù„Ù",tr:"... al-amru...",a:"Ù„ÙÙ„ÙÙ‘Ù‡Ù",opts:["Ù„ÙÙ„ÙÙ‘Ù‡Ù","Ù„ÙÙ„Ù’Ù…ÙÙ„ÙÙƒÙ"]},
            {q:"ÙˆÙÙŠÙÙˆÛ¡Ù…ÙØ¦ÙØ°Ù– ....... Ù±Ù„Û¡Ù…ÙØ¤Û¡Ù…ÙÙ†ÙÙˆÙ†Ù",tr:"Wa yawma-idhin ... al-mouminoun",a:"ÙŠÙÙÛ¡Ø±ÙØ­Ù",opts:["ÙŠÙÙÛ¡Ø±ÙØ­Ù","ÙŠÙØ­Ù’Ø²ÙÙ†Ù"]},
            {q:"ÙˆÙÙ‡ÙÙ… Ù…ÙÙ‘Ù†Û¢ ....... ØºÙÙ„ÙØ¨ÙÙ‡ÙÙ…Û¡",tr:"Wa hum min ... ghalabihim",a:"Ø¨ÙØ¹Û¡Ø¯Ù",opts:["Ø¨ÙØ¹Û¡Ø¯Ù","Ù‚ÙØ¨Ù’Ù„Ù"]},
            {q:"ÙÙÙŠÙ“ Ø£ÙØ¯Û¡Ù†ÙÙ‰ .......",tr:"Fi adna ...",a:"Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù",opts:["Ù±Ù„Û¡Ø£ÙØ±Û¡Ø¶Ù","Ù±Ù„Ø³ÙÙ‘Ù…ÙØ¢Ø¡Ù"]},
            {q:"ÙÙÙŠ Ø¨ÙØ¶Û¡Ø¹Ù .......",tr:"Fi bid'i ...",a:"Ø³ÙÙ†ÙÙŠÙ†Ù",opts:["Ø³ÙÙ†ÙÙŠÙ†Ù","Ø£ÙÙŠÙÙ‘Ø§Ù…Ù"]}
          ]
        }
      }
    },
    // PLACEHOLDERS POUR LES FUTURS MODULES
    "ad-duha": { title: "Ad-Duha", surahId: 93, verses: [], story: {eveil:[],chercheur:[]}, games: {age6:{},age8:{}} }
  };

  // ====================== MOTEUR (ENGINE) ======================
  
  let fontSizes = { ar: 30, tr: 15, fr: 15 };
  let currentData = null;

  function loadModule(id) {
    if(!ModuleContent[id] || ModuleContent[id].verses.length === 0) return alert("Ce module arrive bientÃ´t inchaAllah !");
    currentData = ModuleContent[id];
    document.getElementById('view-hub').style.display='none';
    document.getElementById('view-module').style.display='block';
    window.scrollTo(0,0);
    document.getElementById('mod-title').innerText = currentData.title;
    const cont = document.getElementById('verses-container'); cont.innerHTML='';
    currentData.verses.forEach(v => {
      const c = document.createElement('div'); c.className='verse-card'; c.id=`card-${currentData.surahId}-${v.id}`;
      c.innerHTML=`<div class="verse-header"><span class="badge">Verset ${v.id}</span><div class="audio-controls"><button class="play-btn" id="btn-${currentData.surahId}-${v.id}" onclick="playAyah(${currentData.surahId},${v.id})">â–¶</button></div></div><div class="ar-text">${v.ar}</div><div class="tr-text">${v.tr}</div><div class="fr-text">${v.fr}</div>`;
      cont.appendChild(c);
    });
    // RÃ©appliquer les polices actuelles
    adjustSize('ar', 0); adjustSize('tr', 0);
  }
  
  function goHome() { stopAudio(); document.getElementById('view-module').style.display='none'; document.getElementById('view-hub').style.display='block'; }

  // --- AUDIO ---
  let reciter="Minshawy_Teacher_128kbps", currentAudio=null, currentBtnId=null;
  function changeReciter(v){reciter=v;stopAudio();}
  function toggleLayer(c,b){document.querySelectorAll('.'+c).forEach(e=>e.classList.toggle('d-none')); b.style.opacity=(b.style.opacity==="0.5")?"1":"0.5";}
  function stopAudio(){if(currentAudio){currentAudio.pause();currentAudio=null;} document.querySelectorAll('.play-btn').forEach(b=>{b.classList.remove('playing');b.innerText="â–¶"}); document.querySelectorAll('.verse-card').forEach(c=>c.classList.remove('active'));}
  function playAyah(s,a){
    const btnId=`btn-${s}-${a}`;
    if(currentAudio && currentBtnId===btnId){ if(currentAudio.paused){currentAudio.play();document.getElementById(btnId).innerText="â¸";document.getElementById(btnId).classList.add('playing');}else{currentAudio.pause();document.getElementById(btnId).innerText="â–¶";document.getElementById(btnId).classList.remove('playing');} return; }
    stopAudio(); currentBtnId=btnId;
    const btn=document.getElementById(btnId); if(btn){btn.innerText="â¸";btn.classList.add('playing');}
    const card=document.getElementById(`card-${s}-${a}`); if(card)card.classList.add('active');
    currentAudio=new Audio(`https://everyayah.com/data/${reciter}/${String(s).padStart(3,'0')}${String(a).padStart(3,'0')}.mp3`);
    currentAudio.onended=()=>stopAudio(); currentAudio.play().catch(e=>stopAudio());
  }

  // --- STORY ---
  let currentStoryType='eveil', storyIdx=0;
  function openStoryHub(){if(currentAudio)stopAudio();document.getElementById('story-modal').classList.add('open');document.getElementById('story-age-select').style.display='grid';document.getElementById('story-container').style.display='none';}
  function closeStory(){document.getElementById('story-modal').classList.remove('open');}
  function selectStoryAge(t){currentStoryType=t;document.getElementById('story-age-select').style.display='none';document.getElementById('story-container').style.display='flex';storyIdx=0;renderStory();}
  function renderStory(){
    const list = currentData.story[currentStoryType];
    if(!list || list.length===0){document.getElementById('story-container').innerHTML="<p style='color:white;'>BientÃ´t...</p>";return;}
    const data = list[storyIdx];
    const btnText = (storyIdx < list.length-1) ? "Suivant â¡" : "Terminer âœ…";
    const btnAction = (storyIdx < list.length-1) ? "nextStory()" : "closeStory()";
    document.getElementById('story-container').innerHTML = `
      <div class="story-card">
        <span class="story-img">${data.img}</span><div class="story-title">${data.title}</div><div class="story-text">${data.text}</div>
        <button class="source-btn" onclick="toggleSource(this)">ğŸ” Source</button><div class="source-content">${data.sourceDetail}</div>
      </div>
      <button class="story-nav-btn" onclick="${btnAction}">${btnText}</button>
    `;
  }
  function nextStory(){storyIdx++;renderStory();}
  function toggleSource(btn){const c=btn.nextElementSibling; if(c.style.display==="block"){c.style.display="none";btn.innerHTML="ğŸ” Source";}else{c.style.display="block";btn.innerHTML="âŒ Fermer";}}

  // --- GAMES ENGINE ---
  let currentAge, currentLevel, currentQuestions=[], questionIdx=0;
  const levelOrder=['vocab','puzzle','missing'];
  const screens={age:document.getElementById('age-select-screen'),level:document.getElementById('level-select-screen'),game:document.getElementById('game-area'),win:document.getElementById('level-complete')};
  
  function openGameHub(){if(currentAudio)stopAudio();document.getElementById('game-modal').classList.add('open');resetGame();}
  function closeGameHub(){document.getElementById('game-modal').classList.remove('open');}
  function resetGame(){screens.age.style.display='grid';screens.level.style.display='none';screens.game.style.display='none';screens.win.style.display='none';document.getElementById('progress-track').style.display='none';}
  function selectAge(a){currentAge=a;screens.age.style.display='none';screens.level.style.display='grid';}
  function selectLevel(l){
    currentLevel=l; screens.level.style.display='none'; screens.game.style.display='flex'; screens.win.style.display='none';
    document.getElementById('progress-track').style.display='block';
    const gData = currentData.games[currentAge] && currentData.games[currentAge][currentLevel];
    if(!gData || gData.length===0) { alert("Jeux Ã  venir !"); resetGame(); return; }
    currentQuestions=[...gData].sort(()=>Math.random()-0.5); questionIdx=0; loadQuestion();
  }
  function loadQuestion(){
    if(questionIdx>=currentQuestions.length){finishLevel();return;}
    document.getElementById('progress-fill').style.width=((questionIdx/currentQuestions.length)*100)+'%';
    document.getElementById('correction-box').style.display='none'; isLocked=false;
    const data=currentQuestions[questionIdx];
    const qBox=document.getElementById('question-box'), optGrid=document.getElementById('options-grid'), puzArea=document.getElementById('puzzle-area');
    qBox.innerHTML=''; optGrid.innerHTML=''; optGrid.style.display='none'; puzArea.style.display='none';

    if(currentLevel==='puzzle'){
      puzArea.style.display='block'; qBox.innerHTML=`<div class="q-tr-game" style="color:white; margin-bottom:10px;">${data.tr}</div>`;
      const drop=document.getElementById('puzzle-dropzone'), src=document.getElementById('puzzle-source'); drop.innerHTML=''; src.innerHTML='';
      let userIndices=[], pieces=data.full.map((w,i)=>({w,i}));
      pieces.sort(()=>Math.random()-0.5).forEach(pObj=>{
        const p=document.createElement('div'); p.className='puzzle-piece'; p.innerText=pObj.w; p.dataset.idx=pObj.i;
        p.onclick=function(){
          if(this.parentNode===src){drop.appendChild(this); userIndices.push(parseInt(this.dataset.idx));}
          else{src.appendChild(this); userIndices=userIndices.filter(i=>i!==parseInt(this.dataset.idx));}
          checkPuzzle(userIndices, data.full.length, drop);
        };
        src.appendChild(p);
      });
    } else {
      optGrid.style.display='grid'; qBox.innerHTML=`<div class="q-ar">${data.q}</div><div class="q-tr-game">${data.tr}</div>`;
      [...data.opts].sort(()=>Math.random()-0.5).forEach(opt=>{
        const btn=document.createElement('button'); btn.className='game-btn';
        let valText=(typeof opt==='object')?opt.t:opt;
        btn.innerHTML=(typeof opt==='object')?`<span class="game-btn-icon">${opt.i}</span><span>${opt.t}</span>`:`<span>${opt}</span>`;
        btn.onclick=()=>checkOption(btn, valText, data.a); btn.dataset.val=valText; optGrid.appendChild(btn);
      });
    }
  }
  function checkPuzzle(uIdx, total, drop){
    if(uIdx.length===total){
      if(uIdx.every((v,i)=>v===i)){drop.style.borderColor="#2ecc71"; fireConfetti(); setTimeout(()=>{questionIdx++;loadQuestion();drop.style.borderColor="rgba(255,255,255,0.3)";},1000);}
      else{drop.style.borderColor="#ff4757"; drop.animate([{transform:'translateX(0)'},{transform:'translateX(-10px)'},{transform:'translateX(10px)'},{transform:'translateX(0)'}],{duration:300});}
    }
  }
  function checkOption(btn, sel, corr){
    if(isLocked)return; isLocked=true;
    if(sel===corr){btn.classList.add('correct'); fireConfetti(); setTimeout(()=>{questionIdx++;loadQuestion();},1000);}
    else{btn.classList.add('wrong'); navigator.vibrate?.(300); document.querySelectorAll('.game-btn').forEach(b=>{if(b.dataset.val===corr)b.classList.add('reveal')}); document.getElementById('correction-box').style.display='block'; document.getElementById('correction-box').innerText=`Correction : ${corr}`; setTimeout(()=>{questionIdx++;loadQuestion();},2500);}
  }
  function finishLevel(){
    screens.game.style.display='none'; screens.win.style.display='flex'; fireMassiveConfetti();
    const btn=document.getElementById('next-level-btn'), currentIdx=levelOrder.indexOf(currentLevel);
    if(currentIdx<levelOrder.length-1){ btn.innerText="Jeu Suivant â¡"; btn.onclick=()=>selectLevel(levelOrder[currentIdx+1]); }
    else{ btn.innerText="Menu Principal ğŸ "; btn.onclick=()=>resetGame(); }
  }
  
  function adjustSize(t,d){ 
    fontSizes[t]+=d; 
    if(fontSizes[t]<10)fontSizes[t]=10; 
    if(fontSizes[t]>70)fontSizes[t]=70; 
    
    if(t==='ar')document.querySelectorAll('.ar-text').forEach(e=>e.style.fontSize=fontSizes.ar+'px');
    if(t==='tr')document.querySelectorAll('.tr-text').forEach(e=>e.style.fontSize=fontSizes.tr+'px');
    if(t==='fr')document.querySelectorAll('.fr-text').forEach(e=>e.style.fontSize=fontSizes.fr+'px'); 
  }

  function fireConfetti(){confetti({particleCount:50,spread:60,origin:{y:0.7}});}
  function fireMassiveConfetti(){const end=Date.now()+3000; (function frame(){confetti({particleCount:5,angle:60,spread:55,origin:{x:0},colors:['#00ff88','#fdcb6e']});confetti({particleCount:5,angle:120,spread:55,origin:{x:1},colors:['#00ff88','#fdcb6e']});if(Date.now()<end)requestAnimationFrame(frame);}());}
</script>
</body>
</html>
